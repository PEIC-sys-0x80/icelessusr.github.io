# df指令
#資訊科技 #終端指令 #網路參考資料  #linux/unix指令 #linux

[參考來源](https://www.runoob.com/linux/linux-comm-df.html)

`df` 指令（全拼：**disk free**）用於顯示目前在 Linux/Unix 系統上各個檔案系統（File System）的磁碟使用情況統計資訊。這是系統管理中常用的工具之一，可用於監控磁碟使用狀況、預測容量瓶頸、或是在自動化腳本中實施資源使用限制策略。

---

## 基本語法

```
df [選項] [檔案或目錄]
```

* 如果未指定任何檔案，`df` 會預設列出所有已掛載的檔案系統。
* 指定特定檔案或目錄時，`df` 會顯示該路徑所屬的檔案系統之資訊。

---

## 常見選項說明

| 選項                                   | 說明                                    |
| ------------------------------------ | ------------------------------------- |
| `-a`, `--all`                        | 顯示所有檔案系統，包括虛擬檔案系統（如 `proc`, `sysfs`）等 |
| `-B <SIZE>`                          | 以指定區塊大小顯示（例如 `-B M` 以 MB 顯示）          |
| `-h`, `--human-readable`             | 以人類可讀單位（KB, MB, GB）自動調整顯示格式           |
| `-H`, `--si`                         | 類似 `-h`，但以 1000 為基數（非 1024）使用 SI 單位   |
| `-i`, `--inodes`                     | 顯示 inode 的使用情況，適用於檔案數量為重點時            |
| `-k`                                 | 以 KB 顯示，等同於 `-B 1024`                 |
| `-l`, `--local`                      | 僅顯示本機文件系統，不包含遠端掛載（如 NFS）              |
| `-m`                                 | 以 MB 為單位顯示                            |
| `-n`, `--no-sync`                    | 顯示目前資料，不強制同步磁碟（效能較佳但可能非最新）            |
| `-P`, `--portability`                | 使用 POSIX 標準格式輸出，便於跨平台腳本處理             |
| `-T`, `--print-type`                 | 顯示檔案系統的類型（例如 ext4, xfs）               |
| `-t <TYPE>`, `--type=<TYPE>`         | 僅顯示特定類型的檔案系統                          |
| `-x <TYPE>`, `--exclude-type=<TYPE>` | 排除特定檔案系統類型的顯示                         |
| `--sync`                             | 在顯示前執行檔案系統同步操作（較慢但更準）                 |
| `--total`                            | 在輸出底部添加一行總計資訊                         |
| `-v`, `--verbose`                    | 顯示詳細資訊（實際上部分版本中此選項無實質影響）              |
| `--help`                             | 顯示幫助訊息並結束                             |
| `--version`                          | 顯示版本資訊並結束                             |

---

## 輸出欄位說明

* `Filesystem`: 檔案系統名稱（通常是裝置名稱）
* `1K-blocks`: 總容量（以 1KB 為單位）
* `Used`: 已使用空間
* `Available`: 可用空間
* `Use%`: 使用百分比
* `Mounted on`: 掛載點，即該檔案系統在哪個目錄被掛載

---

## 使用實例

### 基本使用

```bash
df
```

查看所有已掛載磁碟的使用狀況。

---

### 人類可讀格式

```bash
df -h
```

會將容量資訊轉換為易於理解的單位（例如：`29G`, `1.5G`）。

---

### 顯示 inode 使用情況

```bash
df -i
```

查看檔案系統的 inode 使用情況，inode 用於追蹤檔案的元資料，inode 枯竭會導致磁碟無法再儲存新檔案，即使空間未滿。

---

### 顯示總計

```bash
df --total
```

加入所有檔案系統的總合資訊，便於整體容量掌握。

---

### 顯示特定檔案/目錄所屬磁碟資訊

```bash
df /home/user/documents
```

會顯示 `/home/user/documents` 所在的磁碟空間情況。

---

### 顯示檔案系統類型

```bash
df -T
```

這對系統管理員確認檔案系統種類（如 ext4、xfs、tmpfs）非常有用。

---

### 排除虛擬文件系統（如 tmpfs、devtmpfs）

```bash
df -x tmpfs -x devtmpfs
```

排除非實體儲存設備的顯示結果。

---

### 以 MB 顯示

```bash
df -BM
```

強制所有數據以 MB 為單位顯示，方便統一格式作為報告輸出。

---

## 進階應用

### 與 `grep` 搭配過濾

```bash
df -h | grep "^/dev"
```

只列出實體磁碟裝置的使用情況，排除 `tmpfs`、`udev` 等虛擬系統。

---

### 結合腳本監控磁碟空間

以下是一個簡單腳本，當 `/` 根目錄使用率超過 90% 時警示：

```bash
#!/bin/bash
usage=$(df / | awk 'NR==2 {gsub("%","",$5); print $5}')
if [ "$usage" -gt 90 ]; then
    echo "警告：根目錄磁碟使用率已達 $usage%！"
fi
```

---

> **注意事項**
>
>* `df` 的輸出資料可能略落後於實際情況，若對精確性有要求，可加上 `--sync`。
>* `df` 顯示的是 **磁碟區（分割區）** 層級的空間，而非單一目錄。
>* 若某磁碟已使用接近 100%，即便還有 inode 可用，寫入操作仍會失敗。

---
