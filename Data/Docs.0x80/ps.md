# ps指令
#資訊科技  #終端指令 #linux/unix指令 #linux #linux終端-未完成 

`ps`（process status）指令是 Linux/Unix 系統中用來顯示目前系統中正在執行的處理程序（process）的命令。它提供目前系統中活動程序的快照，包括每個程序的 PID（Process ID）、所屬終端機、使用的 CPU 時間、執行的命令等資訊。

```bash
ps
```


### 基本輸出格式：

```
PID     TTY       TIME       CMD
```

* **PID**：處理程序的 ID。
* **TTY**：處理程序所連接的終端裝置（如果有）。
* **TIME**：該處理程序已使用的 CPU 時間總和。
* **CMD**：啟動該處理程序的命令。

---

## 功能描述

`ps` 提供系統中程序狀態的詳細資訊，這對於系統管理員來說，是進行系統監控、偵錯、資源管理的關鍵工具。與 `top` 指令不同，`ps` 顯示的是靜態快照，並不會持續更新。

---
## 指令參數

`ps` 指令提供多樣的選項來調整輸出內容與顯示格式，這些選項大致分為 **System V 風格**（帶有 `-`）與 **BSD 風格**（不加 `-`）兩類。在 GNU/Linux 系統中通常可混用，但在某些 Unix 系統中需遵守風格一致性。

---

### 常用 System V 樣式參數（GNU/Linux 常見）

| 參數          | 說明                              |
| ----------- | ------------------------------- |
| `-A`        | 顯示系統中所有程序（等同於 `-e`）             |
| `-a`        | 顯示所有與終端有關的程序（排除會話領導者）           |
| `-e`        | 顯示所有程序（everyone）                |
| `-f`        | 使用完整格式顯示（full），含 UID、PPID、啟動時間等 |
| `-l`        | 顯示長格式資訊（long format）            |
| `-u <user>` | 顯示特定使用者的程序                      |
| `-p <PID>`  | 僅顯示特定 PID 的程序                   |
| `-t <TTY>`  | 僅顯示特定終端的程序                      |
| `-o <欄位>`   | 自訂輸出欄位                          |
| `--sort`    | 排序輸出，可依 `%cpu`、`%mem` 等欄位排序     |
| `--forest`  | 以樹狀結構顯示程序間的父子關係                 |
| `--help`    | 顯示說明資訊                          |
| `--version` | 顯示版本號                           |

---

### BSD 樣式參數（常見於 `ps aux`）

| 參數  | 說明                        |
| --- | ------------------------- |
| `a` | 顯示所有使用者的程序                |
| `u` | 顯示程序所屬使用者及資源使用情況（CPU、記憶體） |
| `x` | 顯示未連接終端的背景程序              |

**常見用法：**

```bash
ps aux        # 顯示所有使用者、所有程序（包括背景）
ps -ef        # System V 樣式的完整輸出
```

---

### 可搭配 `-o` 使用的輸出欄位（部分常見）

| 欄位名稱    | 說明                        |
| ------- | ------------------------- |
| `pid`   | 程序 ID                     |
| `ppid`  | 父程序 ID                    |
| `uid`   | 使用者 ID                    |
| `user`  | 使用者名稱                     |
| `cmd`   | 執行命令（含參數）                 |
| `comm`  | 程序名稱（不含參數）                |
| `%cpu`  | CPU 使用率                   |
| `%mem`  | 記憶體使用率                    |
| `etime` | 程序執行經過時間                  |
| `stime` | 開始時間                      |
| `tty`   | 所屬終端                      |
| `stat`  | 程序狀態（R：執行中，S：睡眠中，Z：殭屍程序等） |

**例：**

```bash
ps -eo pid,ppid,user,%cpu,%mem,cmd --sort=-%mem
```

上述指令會依記憶體使用率降序列出所有程序，顯示自訂欄位。

**常見變體：**

| 指令        | 說明                            |
| --------- | ----------------------------- |
| `ps -aux` | 顯示所有使用者的處理程序（BSD風格）           |
| `ps -ef`  | 顯示所有處理程序（System V風格，常見於Linux） |
| `ps -eo`  | 自訂輸出欄位格式                      |


---

## 常見用途：

1. **查看當前使用者的程序：**

   ```shell
   ps
   ```

   僅列出目前使用者所擁有的處理程序:

   ```shell
   ps -u $USER
   ```

   

2. **查看所有處理程序：**

   ```shell
   ps -e
   ```

   顯示系統上所有正在執行的程序:

   ```shell
   ps -A
   ```

   

3. **以全格式列出詳細資訊：**

   ```shell
   ps -ef
   ```

   * `-e`：列出所有程序。
   * `-f`：使用 full 格式輸出，包含 PPID、UID、起始時間等欄位。

4. **樹狀結構顯示程序關係：**

   ```shell
   ps -ejH
   ```

可用於觀察父子程序之間的關係，例如在偵測殭屍程序或孤兒程序時非常實用:

   ```shell
   ps axjf
   ```



---

## 進階用法：

### 1. 搭配 `grep` 搜尋特定程序：

```shell
ps -ef | grep apache
```

這可用來查找某個特定應用（如 Apache、MySQL、Python 等）是否在執行中。

### 2. 顯示特定使用者的程序：

```shell
ps -u username
```

列出特定使用者所執行的所有處理程序。

### 3. 顯示特定 PID 的資訊：

```shell
ps -p 6666
```

顯示 PID 為 6666 的處理程序的詳細資訊。

### 4. 顯示特定欄位：

```shell
ps -eo pid,ppid,cmd,%mem,%cpu
```

此方式使用 `-e` 顯示所有程序，並透過 `-o` 選項自訂輸出欄位（例如顯示記憶體與 CPU 使用率等）。

### 5. 查看多層次程序樹狀關係（更清楚的父子程序關聯）：

```shell
ps -eo pid,ppid,cmd --forest
```

---

## 與其他工具的結合：

* 搭配 `watch` 指令，可定時刷新查看：

  ```shell
  watch -n 1 'ps -ef | grep nginx'
  ```

* 搭配 `awk`、`sort` 分析高資源占用程序：

  ```shell
  ps -eo pid,ppid,cmd,%mem,%cpu --sort=-%mem | head
  ```

  上述指令列出記憶體使用最多的前幾個程序。

---

>**小技巧與注意事項：**
>
> `ps` 在不同平台（如 BSD 與 GNU/Linux）上有些微差異，選項可能不同。GNU/Linux 通常支援 UNIX 標準風格（如 `ps -ef`），而 BSD 樣式則寫成 `ps aux`。
> 若使用容器技術（如 Docker），需注意 ps 所顯示的是容器內部的處理程序，而非宿主系統的全貌。

---